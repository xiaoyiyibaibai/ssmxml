!function(t){var n=function(){this.handlers={}};n.prototype={constructor:n,addHandler:function(t,n){"undefined"==typeof this.handlers[t]&&(this.handlers[t]=[]),this.handlers[t].push(n)},emit:function(t){var n,e,i;if(t.target||(t.target=this),this.handlers[t.type]instanceof Array)for(n=this.handlers[t.type],e=0,i=n.length;e<i;++e)n[e](t)},removeHandler:function(t,n){var e,i,o;if(this.handlers[t]instanceof Array)for(e=this.handlers[t],i=0,o=e.length;i<o;++i)if("function"==typeof e[i]&&e[i]===n){e.splice(i,1);break}}},t.CJLEvent=new n}(window),function(t,n,e,i){var o,r=function(t){this.__element=t,this.__options={},this.__tagAttr="data-traceid"};r.of=function(t){if(!t instanceof HTMLElement)throw new Error("Ga must need a HTMLElement instance!");return new r(t)},r.prototype={constructor:r,post:function(t,e){var i,o=this.getURL(t,e);o&&(i=n.createElement("img"),i.setAttribute("src",o),i.setAttribute("style","display:none;"),n.body.appendChild(i),i.addEventListener("load",function(){n.body.removeChild(i)}),i.addEventListener("error",function(){n.body.removeChild(i)}))},getId:function(t){return t.getAttribute(this.__tagAttr)},getURL:function(t,n){var e,i=this.__options;if(t&&n)return e=i.domain+"/action/trace/record?e=",e+=t,e+="&aid="+n,i.hasOwnProperty("userId")&&(e+="&uid="+i.userId),e},handlers:{pv:function(t){"function"==typeof t.fn&&t.fn()},click:function(t){"function"==typeof t.fn&&t.fn()}},setUp:function(t){if("object"!=typeof t)throw new Error("Ga options must be an Object!");if(!t.hasOwnProperty("domain")&&"string"!=typeof t.domain)throw new Error("Ga options need domain property!");this.__options=t;var n=this.getId(this.__element);return e.addHandler("pv"+n,this.handlers.pv),e.addHandler("click"+n,this.handlers.click),this},watch:function(){var i=this,o=this.__element,r=i.getId(o),a=t.requestAnimationFrame||t.webkitRequestAnimationFrame||t.mozRequestAnimationFrame||t.oRequestAnimationFrame||t.msRequestAnimationFrame,s=i.throttle(function(){a(function(){i.isElementInViewport(o)&&e.emit({type:"pv"+r,fn:function(){e.removeHandler("pv"+r,i.handlers.pv),i.post("pv",i.getId(o))}})})},150);s(),n.addEventListener("scroll",s,!1),o.addEventListener("click",function(){e.emit({type:"click"+r,fn:function(){i.post("click",i.getId(o))}})},!1)},throttle:function(t,n,e){var i,o,r,a,s,d,c={now:Date.now||function(){return(new Date).getTime()}},u=0;return e||(e={}),s=function(){u=e.leading===!1?0:c.now(),i=null,a=t.apply(o,r),i||(o=r=null)},d=function(){var d,l=c.now();return u||e.leading!==!1||(u=l),d=n-(l-u),o=this,r=arguments,d<=0||d>n?(i&&(clearTimeout(i),i=null),u=l,a=t.apply(o,r),i||(o=r=null)):i||e.trailing===!1||(i=setTimeout(s,d)),a},d.cancel=function(){clearTimeout(i),u=0,i=o=r=null},d},isElementInViewport:function(e){var i=e.getBoundingClientRect();return i.top>=0&&i.left>=0&&i.bottom<=(t.innerHeight||n.documentElement.clientHeight)&&i.right<=(t.innerWidth||n.documentElement.clientWidth)}},t.Ga=r,o={},"object"==typeof i&&(i.hasOwnProperty("domain")&&"string"==typeof i.domain&&(o.domain="//"+i.domain),i.hasOwnProperty("userId")&&(o.userId=i.userId)),n.querySelectorAll("[data-traceid]").forEach(function(t){r.of(t).setUp(o).watch()})}(window,window.document,CJLEvent,window.__gac);